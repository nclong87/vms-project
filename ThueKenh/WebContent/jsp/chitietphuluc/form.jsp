<%@ taglib prefix="s" uri="/struts-tags"%><s:url action="doSaveChiTietPhuLuc" namespace="/chitietphuluc" var="doSaveChiTietPhuLucURL"/><form id="frmLuuPhuLuc" onsubmit="return false"><div id="msg"></div><input type="text" name="chiTietPhuLucDTO.id" id="id" style="display:none" value="<s:property value='json.id' />"/><input type="text" id="tenCTPL" style="display:none" value="<s:property value='json.tenchitietphuluc' />"/><input type="text" name="chiTietPhuLucDTO.cuocdaunoi" id="cuocdaunoi" style="display:none" value="<s:property value='json.cuocDauNoi' />"/><input type="text" name="chiTietPhuLucDTO.giatritruocthue" id="giatritruocthue" style="display:none" value="<s:property value='json.giaTriTruocThue' />"/><input type="text" name="chiTietPhuLucDTO.giatrisauthue" id="giatrisauthue" style="display:none" value="<s:property value='json.giaTriSauThue' />"/><input type="text" name="chiTietPhuLucDTO.soluongkenh" id="soluongkenh" style="display:none" value="<s:property value='json.soLuongKenh' />"/><ul>	<li>Tổng số kênh : <s:property value="json.soLuongKenh" /></li>	<li>Cước đấu nối hòa mạng: <b><s:property value="json.cuocDauNoi" /></b> VNĐ</li>	<li>Giá trị trước thuế: <b><s:property value="json.giaTriTruocThue" /></b> VNĐ</li>	<li>Giá trị sau thuế: <b><s:property value="json.giaTriSauThue" /></b> VNĐ</li>	<li>Bạn có muốn lưu giá trị phụ lục này không ?  <input type="radio" value="1" name="check" class="check">Có</input><input type="radio" value="0" name="check" class="check">Không</input></li>	<li id="show" style="display:none">		<div style="display:block">Tên giá trị phụ lục muốn lưu: <input type="text" name="chiTietPhuLucDTO.tenchitietphuluc" id="tenchitietphuluc" style="width: 200px"></input></div>		<div style="width: 100%; text-align: right;">		<input class="button" type="button" id="btSubmit" value="Lưu" onclick="doSearch()"/>		<input class="button" type="button" id="btThoatForm" value="Thoát"/>		</div>	</li></ul></form><script>function message(msg,type) {	if(msg == '') {		$("#frmLuuPhuLuc #msg").html('');		return;	}	if(type == 1) {		$("#frmLuuPhuLuc #msg").html('<div class="ui-state-highlight ui-corner-all" style=" padding: 0pt 0.7em; text-align: left;"><p style="padding: 5px;"><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span><strong>Success! </strong> '+msg+'</p></div>');	} else {		$("#frmLuuPhuLuc #msg").html('<div style="padding: 0pt 0.7em; text-align: left;" class="ui-state-error ui-corner-all"><p style="padding: 5px;"><span style="float: left; margin-right: .3em;" class="ui-icon ui-icon-alert"></span><strong>Error : </strong> '+msg+'</p></div>');	}}$(document).ready(function(){	$("#btThoatForm").click(function(){		$("#dialog").dialog("close");	});	$("#frmLuuPhuLuc b").formatCurrency({ 		region : 'vn',		roundToDecimalPlace: 0, 		eventOnDecimalsEntered: true 	});	$("#frmLuuPhuLuc input[name=check]").click(function(){		if(this.value == "1") {			$("#frmLuuPhuLuc li#show").show();			if($("#tenCTPL").val()!="")			{				$("#frmLuuPhuLuc #tenchitietphuluc").val($("#tenCTPL").val());				//$("#frmLuuPhuLuc #tenchitietphuluc").attr("disabled",true);			}			else			{				//$("#frmLuuPhuLuc #tenchitietphuluc").attr("disabled",false);			}			$("#frmLuuPhuLuc #tenchitietphuluc").focus();		} else {			$("#frmLuuPhuLuc li#show").hide();		}	});	$("#btSubmit").click(function() {		var button = this;		if ($("#frmLuuPhuLuc #tenchitietphuluc").val() == "") {			alert("Vui lòng nhập tên chi tiết phụ lục cần lưu!");			button.disabled = false;		} else {			button.disabled = true;			var dataString = $("#frmLuuPhuLuc").serialize();				$.ajax({				url: "${doSaveChiTietPhuLucURL}",				type:'POST',				data:dataString,				success:function(response){					button.disabled = false;					if(response.status == "ERROR") {						if(response.data == "END_SESSION") {							location.href = LOGIN_PATH;							return;						}						if(response.data == "DUPLICATE") {							message("Tên "+$("#frmLuuPhuLuc #tenchitietphuluc").val()+ " đã được sử dụng, vui lòng chọn tên khác",0);							$("#frmLuuPhuLuc #tenchitietphuluc").focus();							return;						}						message("Lưu không thành công, vui lòng thử lại.",0);					} else if(response.status == "OK") {						message("Lưu thành công!",1);					}				},				error:function(response){					button.disabled = false;					alert("Lỗi kết nối server, vui lòng thử lại sau!");				}			});		}		return false;	});});</script>