<%@ page language="java" contentType="text/html; charset=UTF-8"	pageEncoding="UTF-8"%><%@ taglib prefix="s" uri="/struts-tags"%><s:url action="detailLoaiGiaoTiep" namespace="/danhmuc" id="detailLoaiGiaoTiepURL" /><s:url action="lichSuTuyenKenh" namespace="/ajax" id="lichSuTuyenKenhURL" /><s:url action="detail" namespace="/thanhtoan" id="detailThanhToanURL" /><s:url action="detail" namespace="/phuluc" id="detailPhuLucURL" /><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><%	String contextPath = request.getContextPath();%><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="description" content="Reflect Template" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><title>Xem chi tiết tuyến kênh : <s:property value="detail.id"/></title><link rel="stylesheet" href="<%= contextPath %>/css/detailpage.css" type="text/css" media="screen" /><script>var contextPath = '<%= contextPath %>';var baseUrl = contextPath;function byId(id) { //Viet tat cua ham document.getElementById	return document.getElementById(id);}</script><script type='text/javascript' src='<%= contextPath %>/js/jquery.js'></script><script type="text/javascript" src="<%=contextPath%>/js/trangthai_utils.js"></script><script type="text/javascript" src="<%=contextPath%>/js/mylibs/history.js"></script></head><body>	<div id="bg_wrapper">		<h3>THÔNG TIN CHI TIẾT TUYẾN KÊNH</h3>		<dt>Mã kênh :</dt>		<dd><s:property value="detail.id"/></dd>		<dt>Mã điểm đầu :</dt>		<dd><s:property value="detail.madiemdau"/></dd>		<dt>Mã điểm cuối :</dt>		<dd><s:property value="detail.madiemcuoi"/></dd>		<dt>Giao tiếp :</dt>		<dd><a href="${detailLoaiGiaoTiepURL}?id=<s:property value='detail.giaotiep_id'/>" target="_blank"><s:property value='detail.loaigiaotiep'/></a></dd>		<dt>Dung lượng :</dt>		<dd><s:property value='detail.dungluong'/> Mb</dd>		<dt>Số lượng :</dt>		<dd><s:property value='detail.soluong'/></dd>		<dt>Dự án :</dt>		<dd><s:property value='detail.tenduan'/></dd>		<dt>Đơn vị chủ trì nhận kênh :</dt>		<dd><s:property value='detail.tenphongban'/></dd>		<dt>Đối tác :</dt>		<dd><s:property value='detail.tendoitac'/></dd>		<dt>Trạng thái :</dt>		<dd id="trangthai"></dd>		<dt>Thông tin lịch sử :</dt>		<dd>			<ul id="history">						</ul>			<span id="load_more" title="Xem dữ liệu lịch sử cũ hơn" onclick="loadHistory()">Xem thêm...</span>		</dd>	</div></body></html><script>var matrangthai = "<s:property value='detail.trangthai'/>";var id = "<s:property value='detail.id'/>";function loadHistory() {	history.loading();	$.ajax({		url: "${lichSuTuyenKenhURL}",		data: {id:id,p:history.page},		cache: false,		success: function(response){			history.loading(false);			if(response.status == 0) {				$("ul#history").append("<li class='error'>Có lỗi xảy ra khi load lịch sử tuyến kênh</li>");			} else {				$.each(response.data,function(){					var msg = '[ '+this.timeaction + " ] : ";					this.useraction = "<b>"+this.useraction+"</b>";					switch(this.action) {						case "1" : 							msg += this.useraction + " tạo mới dữ liệu.";							break;						case "2" : 							msg += this.useraction + " xóa dữ liệu.";							break;						case "3" : 							msg += this.useraction + " cập nhật dữ liệu.";							break;						case "4" :							var data = this.info[0];							msg += this.useraction + ' đưa vào phụ lục. (<a target="_blank" href="${detailPhuLucURL}?id='+data.phuluc_id+'">'+data.tenphuluc+'</a>)';							break;						case "5" : 							var data = this.info[0];							msg += this.useraction + ' cập nhật trạng thái thanh toán. (<a target="_blank" href="${detailThanhToanURL}?id='+data.sohoso_id+'">'+data.sohoso+'</a>)';							break;						case "6" : 							var data = this.info[0];							msg += this.useraction + ' thêm mới đề xuất. (<span class="link" id="viewVanBanDeXuatByTuyenKenhDeXuat" data_ref_id="'+data.id+'">Xem văn bản đề xuất</span>)';							break;						case "7" : 							var data = this.info[0];							msg += this.useraction + ' hủy đề xuất. (<span class="link" id="viewVanBanDeXuatByTuyenKenhDeXuat" data_ref_id="'+data.id+'">Xem văn bản đề xuất</span>)';							break;						case "8" : 							var data = this.info[0];							msg += this.useraction + ' cập nhật đề xuất. (<span class="link" id="viewVanBanDeXuatByTuyenKenhDeXuat" data_ref_id="'+data.id+'">Xem văn bản đề xuất</span>)';							break;						case "9" : 							msg += this.useraction + ' cập nhật tiến độ bàn giao kênh.';							break;					}					$("ul#history").append("<li>"+msg+"</li>");				});				history.page++;				//debugger;				if(response.data.length < response.LS_MAX_PAGE_LENGHT) {					$("span#load_more").hide();				}			}		}	});}$(document).ready(function() {	loadHistory();	$("#trangthai").text(trangthai_utils.tuyenkenhText(matrangthai));	history.init();});</script>